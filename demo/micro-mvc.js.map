{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/index.js"],"names":["f","exports","module","define","amd","window","global","self","this","mvc","r","e","n","t","o","i","c","require","u","a","Error","code","p","call","length","1","MVCEventEmitter","_classCallCheck","listeners","type","callback","push","stack","l","splice","event","slice","defaultPrevented","Model","dataModel","_this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","_loop","k","defineProperty","innumerable","get","set","val","CustomEvent","detail","model","property","value","dispatchEvent","_arr","keys","_i","assign","updates","properties","values","View","viewDOM","_this2","observers","querySelectorAll","controls","getControlValue","control","tagName","innerHTML","updateObserver","observer","_loop2","controlledValues","getAttribute","split","_loop4","addEventListener","ce","target","_loop3","observedValues","_loop5","_observedValues"],"mappings":"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","file":"micro-mvc.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","//MVCEventEmitter class slightly modified from\n//https://developer.mozilla.org/en-US/docs/Web/API/EventTarget#_Simple_implementation_of_EventTarget\nclass MVCEventEmitter {\n  constructor() {\n    this.listeners = {};\n  }\n\n  addEventListener(type, callback) {\n    if (!(type in this.listeners)) {\n      this.listeners[type] = [];\n    }\n    this.listeners[type].push(callback);\n  }\n\n  removeEventListener(type, callback) {\n    if (!(type in this.listeners)) {\n      return;\n    }\n    var stack = this.listeners[type];\n    for (var i = 0, l = stack.length; i < l; i++) {\n      if (stack[i] === callback) {\n        stack.splice(i, 1);\n        return;\n      }\n    }\n  }\n\n  dispatchEvent(event) {\n    if (!(event.type in this.listeners)) {\n      return true;\n    }\n    var stack = this.listeners[event.type].slice();\n\n    for (var i = 0, l = stack.length; i < l; i++) {\n      stack[i].call(this, event);\n    }\n    return !event.defaultPrevented;\n  }\n}\n\nclass Model extends MVCEventEmitter {\n  constructor(dataModel) {\n    super();\n    for (let k of Object.keys(dataModel)) {\n\n      Object.defineProperty(this, k, {\n        innumerable: true,\n        get: () => {\n          return dataModel[k];\n        },\n        set: (val) => {\n          dataModel[k] = val;\n          let e = new CustomEvent(`mvc-propertychanged`, {\n            detail: {\n              model: dataModel,\n              property: k,\n              value: val\n            }\n          });\n          this.dispatchEvent(e);\n        }\n      });\n    }\n\n    //TODO: determine whether access to the model is required\n    Object.defineProperty(this, 'model', {\n      innumerable: true,\n      get: () => {\n        return dataModel;\n      }\n    });\n\n    let modify = (val) => {\n      Object.assign(dataModel, val);\n      //In some situations, it may be too computationally\n      //intensive to make updates to all listeners to model,\n      //so providing a list of the properties and values that\n      //were changed and the raw val object as \"updates\" so\n      //that only the updates are necessary to process\n      let e = new CustomEvent('mvc-modelmodified', {\n        detail: {\n          updates: val,\n          model: dataModel,\n          properties: [Object.keys(val)],\n          values: [Object.values(val)]\n        }\n      });\n\n      this.dispatchEvent(e);\n    };\n\n    Object.defineProperty(this, 'modify', {\n      value: modify\n    });\n  }\n\n}\n\nclass View extends MVCEventEmitter {\n  constructor(viewDOM, model) {\n    super();\n\n    let observers = viewDOM.querySelectorAll('[mvc-observes]');\n    let controls = viewDOM.querySelectorAll('[mvc-controls]');\n\n\n    function getControlValue(control) {\n      switch (control.tagName) {\n        case \"INPUT\":\n          return control.value;\n          //case \"TEXTAREA\":\n          //return control.innerHTML;\n        default:\n          return control.innerHTML;\n      }\n    }\n\n    function updateObserver(observer, value) {\n      switch (observer.tagName) {\n        //TODO: write adapter for each observer\n        //TODO: implement custom handlers\n        case \"INPUT\":\n          observer.value = value;\n          break;\n        //case \"SELECT\":\n        default:\n          observer.innerHTML = value;\n          break;\n      }\n    }\n\n    for (let i = 0; i < controls.length; i++) {\n      let controlledValues = controls[i].getAttribute('mvc-controls').split(',');\n      for (let val in controlledValues) {\n        controls[i].addEventListener('change', (e) => {\n          let ce = new CustomEvent(`mvc-inputchanged`, {\n            target: e.target,\n            detail: {\n              property: controlledValues[val],\n              value: getControlValue(controls[i])\n            }\n          });\n          model[controlledValues[val]] = getControlValue(controls[i]);\n          this.dispatchEvent(ce);\n        });\n      }\n    }\n\n    for (let i = 0; i < observers.length; i++) {\n      let observedValues = observers[i].getAttribute('mvc-observes').split(',');\n      for (let val in observedValues) {\n        model.addEventListener(`mvc-propertychanged`, (e) => {\n          if (observedValues[val] === e.detail.property && e.target !== observers[i]) {\n            updateObserver(observers[i], e.detail.value);\n          }\n        });\n      }\n    }\n\n    model.addEventListener(`mvc-modelmodified`, (e) => {\n      for (let i = 0; i < observers.length; i++) {\n        let observedValues = observers[i].getAttribute('mvc-observes').split(',');\n        for (let val in observedValues) {\n          updateObserver(observers[i], e.detail.updates[observedValues[val]]);\n        }\n      }\n    });\n  }\n}\n\nexport {\n  Model,\n  View\n};\n"]}