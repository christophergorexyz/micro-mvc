(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.mvc=f()}})(function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}module.exports=_assertThisInitialized},{}],2:[function(require,module,exports){function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}module.exports=_classCallCheck},{}],3:[function(require,module,exports){function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}module.exports=_createClass},{}],4:[function(require,module,exports){function _getPrototypeOf(o){module.exports=_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}module.exports=_getPrototypeOf},{}],5:[function(require,module,exports){var setPrototypeOf=require("./setPrototypeOf");function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)setPrototypeOf(subClass,superClass)}module.exports=_inherits},{"./setPrototypeOf":8}],6:[function(require,module,exports){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}module.exports=_interopRequireDefault},{}],7:[function(require,module,exports){var _typeof=require("../helpers/typeof");var assertThisInitialized=require("./assertThisInitialized");function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return assertThisInitialized(self)}module.exports=_possibleConstructorReturn},{"../helpers/typeof":9,"./assertThisInitialized":1}],8:[function(require,module,exports){function _setPrototypeOf(o,p){module.exports=_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}module.exports=_setPrototypeOf},{}],9:[function(require,module,exports){function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){module.exports=_typeof=function _typeof(obj){return _typeof2(obj)}}else{module.exports=_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}module.exports=_typeof},{}],10:[function(require,module,exports){"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.View=exports.Model=void 0;var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var MVCEventEmitter=function(){function MVCEventEmitter(){(0,_classCallCheck2["default"])(this,MVCEventEmitter);this.listeners={}}(0,_createClass2["default"])(MVCEventEmitter,[{key:"addEventListener",value:function addEventListener(type,callback){if(!(type in this.listeners)){this.listeners[type]=[]}this.listeners[type].push(callback)}},{key:"removeEventListener",value:function removeEventListener(type,callback){if(!(type in this.listeners)){return}var stack=this.listeners[type];for(var i=0,l=stack.length;i<l;i++){if(stack[i]===callback){stack.splice(i,1);return}}}},{key:"dispatchEvent",value:function dispatchEvent(event){if(!(event.type in this.listeners)){return true}var stack=this.listeners[event.type].slice();for(var i=0,l=stack.length;i<l;i++){stack[i].call(this,event)}return!event.defaultPrevented}}]);return MVCEventEmitter}();var Model=function(_MVCEventEmitter){(0,_inherits2["default"])(Model,_MVCEventEmitter);function Model(dataModel){var _this;(0,_classCallCheck2["default"])(this,Model);_this=(0,_possibleConstructorReturn2["default"])(this,(0,_getPrototypeOf2["default"])(Model).call(this));var _loop=function _loop(){var k=_Object$keys[_i];Object.defineProperty((0,_assertThisInitialized2["default"])(_this),k,{innumerable:true,get:function get(){return dataModel[k]},set:function set(val){dataModel[k]=val;var e=new CustomEvent("mvc-propertychanged",{detail:{model:dataModel,property:k,value:val}});_this.dispatchEvent(e)}})};for(var _i=0,_Object$keys=Object.keys(dataModel);_i<_Object$keys.length;_i++){_loop()}Object.defineProperty((0,_assertThisInitialized2["default"])(_this),"model",{innumerable:true,get:function get(){return dataModel}});var modify=function modify(val){Object.assign(dataModel,val);var e=new CustomEvent("mvc-modelmodified",{detail:{updates:val,model:dataModel,properties:[Object.keys(val)],values:[Object.values(val)]}});_this.dispatchEvent(e)};Object.defineProperty((0,_assertThisInitialized2["default"])(_this),"modify",{value:modify});return _this}return Model}(MVCEventEmitter);exports.Model=Model;var View=function(_MVCEventEmitter2){(0,_inherits2["default"])(View,_MVCEventEmitter2);function View(viewDOM,model){var _this2;(0,_classCallCheck2["default"])(this,View);_this2=(0,_possibleConstructorReturn2["default"])(this,(0,_getPrototypeOf2["default"])(View).call(this));var observers=viewDOM.querySelectorAll("[mvc-observes]");var controls=viewDOM.querySelectorAll("[mvc-controls]");function getControlValue(control){switch(control.tagName){case"INPUT":return control.value;default:return control.innerHTML}}function updateObserver(observer,value){switch(observer.tagName){case"INPUT":observer.value=value;break;default:observer.innerHTML=value;break}}var _loop2=function _loop2(i){var controlledValues=controls[i].getAttribute("mvc-controls").split(",");var _loop4=function _loop4(val){controls[i].addEventListener("change",function(e){var ce=new CustomEvent("mvc-inputchanged",{target:e.target,detail:{property:controlledValues[val],value:getControlValue(controls[i])}});model[controlledValues[val]]=getControlValue(controls[i]);_this2.dispatchEvent(ce)})};for(var val in controlledValues){_loop4(val)}};for(var i=0;i<controls.length;i++){_loop2(i)}var _loop3=function _loop3(i){var observedValues=observers[i].getAttribute("mvc-observes").split(",");var _loop5=function _loop5(val){model.addEventListener("mvc-propertychanged",function(e){if(observedValues[val]===e.detail.property&&e.target!==observers[i]){updateObserver(observers[i],e.detail.value)}})};for(var val in observedValues){_loop5(val)}};for(var i=0;i<observers.length;i++){_loop3(i)}model.addEventListener("mvc-modelmodified",function(e){for(var i=0;i<observers.length;i++){var observedValues=observers[i].getAttribute("mvc-observes").split(",");for(var val in observedValues){updateObserver(observers[i],e.detail.updates[observedValues[val]])}}});return _this2}return View}(MVCEventEmitter);exports.View=View},{"@babel/runtime/helpers/assertThisInitialized":1,"@babel/runtime/helpers/classCallCheck":2,"@babel/runtime/helpers/createClass":3,"@babel/runtime/helpers/getPrototypeOf":4,"@babel/runtime/helpers/inherits":5,"@babel/runtime/helpers/interopRequireDefault":6,"@babel/runtime/helpers/possibleConstructorReturn":7}]},{},[10])(10)});
